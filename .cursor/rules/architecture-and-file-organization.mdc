---
description: Architectural patterns, file organization, and data flow.
globs: src/**/*
alwaysApply: true
---
# Architecture & File Organization

## Project Structure

Follow the documented hierarchy in `docs/technical/architecture.md`:

- `src/pages/`: Route-level components (<300 LOC). Use lazy loading.
- `src/components/[feature]/`: Feature-specific logic (e.g., `equipment/`, `work-orders/`).
- `src/components/ui/`: Reusable primitives (shadcn-style). **No business logic here.**
- `src/hooks/`: Custom hooks for data fetching and logic.
- `src/services/`: Stateless API logic and Supabase queries.

## Core Patterns

- **Container/Presentational**:
  - **Containers** (often Pages or top-level components): Handle data fetching (`useQuery`), mutations, and state.
  - **Presentational**: Receive data via props. Pure UI rendering.
- **Multi-Tenancy**:
  - Every data fetching hook/service **MUST** accept and use `organization_id`.
  - Never hardcode organization IDs. Use `useOrganization()` context.
- **Compound Components**: Use for complex, flexible UIs (e.g., `EquipmentCard.Header`).

## Data Flow

1. **Service**: specific Supabase query (e.g., `.eq('organization_id', orgId)`).
2. **Hook**: TanStack Query wrapper (handles caching, keys, error states).
3. **Component**: Consumes the hook.

## File Naming

- Files/Folders: `kebab-case` (e.g., `equipment-list.tsx`).
- Components: `PascalCase` (e.g., `EquipmentList`).
- Hooks: `camelCase` (e.g., `useEquipment`).
