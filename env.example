# ─────────────────────────────────────────────────────────────────────────────
# EquipQR — env.example
# Copy to .env for local development. Do NOT commit your filled .env.
# Client-readable variables MUST be prefixed with VITE_ (Vite exposes them).
# Server-only secrets live in Supabase Edge Function secrets, or in
# supabase/functions/.env ONLY for local 'supabase functions serve'.
# ─────────────────────────────────────────────────────────────────────────────

# ── Client (Vite) — safe to expose to the browser
VITE_SUPABASE_URL=
    # Used to init the browser Supabase client. Files: src/integrations/supabase/client.ts
VITE_SUPABASE_ANON_KEY=
    # Used with the above to init the client. File: src/integrations/supabase/client.ts.
VITE_HCAPTCHA_SITEKEY=
    # Used by the sign-up form and HCaptcha UI to render and gate captcha. Files: src/components/auth/SignUpForm.tsx, src/components/ui/HCaptcha.tsx. Keep. Note: this must be your public “site key” (not the secret).
VITE_SUPER_ADMIN_ORG_ID=
    # Used to unlock super-admin tools for a specific org in the UI. File: src/hooks/useSuperAdminAccess.ts.

# ── QuickBooks Online OAuth (Client)
VITE_INTUIT_CLIENT_ID=
    # QuickBooks OAuth client ID from Intuit Developer Portal. Required for generating OAuth authorization URL.
    # Files: src/services/quickbooks/auth.ts
    # Note: This is safe to expose to the client (used to initiate OAuth flow).
VITE_QB_OAUTH_REDIRECT_BASE_URL=
    # OAuth redirect base URL. Defaults to VITE_SUPABASE_URL if not set.
    # Must match what's registered in Intuit Developer Portal.
    # Full redirect URI: {this value}/functions/v1/quickbooks-oauth-callback
    # Files: src/services/quickbooks/auth.ts

# ── Feature Flags
BILLING_DISABLED=true
    # When set to true, disables all billing and payment features. Users will have access to all features regardless of subscription status. Default: true (billing disabled)
    # This flag allows staged removal of Stripe integration while maintaining app functionality.
    # DEPRECATED: The following Stripe variables are no longer used but kept for rollback compatibility.
    # STRIPE_SECRET_KEY=
    # STRIPE_WEBHOOK_SECRET=

VITE_ENABLE_QUICKBOOKS=false
    # When set to 'true', enables QuickBooks Online integration features (OAuth connection, customer mapping, invoice export).
    # Default: false (disabled). Only enable in environments where INTUIT_CLIENT_ID and INTUIT_CLIENT_SECRET are configured.
    # Files: src/lib/flags.ts, src/components/organization/QuickBooksIntegration.tsx, src/components/teams/QuickBooksCustomerMapping.tsx

VITE_ENABLE_QB_PDF_ATTACHMENT=false
    # When set to 'true', enables PDF attachment feature for QuickBooks invoice exports.
    # When enabled, a PDF containing public work order details, notes, and images will be attached to exported invoices.
    # Default: false (disabled). Requires ENABLE_QB_PDF_ATTACHMENT to also be set in Supabase Edge Function secrets.
    # Files: src/lib/flags.ts, supabase/functions/quickbooks-export-invoice/index.ts

# ── Server / Edge Functions — DO NOT EXPOSE TO CLIENT
# DEPRECATED: Stripe integration removed. Variables below kept for rollback compatibility only.
STRIPE_SECRET_KEY=
    # DEPRECATED - Used by billing Edge Functions (now disabled). Files: supabase/functions/create-checkout/, create-fleetmap-checkout/, purchase-user-licenses/, customer-portal/, check-subscription/, stripe-fleetmap-webhook/, stripe-license-webhook/.
STRIPE_WEBHOOK_SECRET=
    # DEPRECATED - Used by Stripe webhook handlers (now disabled). Files: supabase/functions/stripe-fleetmap-webhook/, stripe-license-webhook/.
SUPABASE_SERVICE_ROLE_KEY=
    # Used by many Edge Functions to perform privileged DB ops. Files include: list-organizations-admin, manage-billing-exemptions, geocode-location, refresh-fleetmap-subscription, import-equipment-csv, etc.
RESEND_API_KEY=
    # Used to send invitation emails. File: supabase/functions/send-invitation-email/index.ts.
HCAPTCHA_SECRET_KEY=
    # Used to verify captcha server-side. File: supabase/functions/verify-hcaptcha/index.ts. Note: must be your hCaptcha “secret key” (different from the site key).
SUPABASE_URL=
    # Used by many functions to create a Supabase client; also used as a fallback in invitation email link building. Files: multiple functions (grep shows references).
SUPABASE_ANON_KEY=
    # Used by a couple of Edge Functions that create a non-privileged client (e.g., create-checkout, create-fleetmap-checkout).
PRODUCTION_URL=
    # Used by send-invitation-email to build the invite URL base. File: supabase/functions/send-invitation-email/index.ts. For production, set to https://equipqr.app. In local dev, using http://localhost:8080 is fine when running functions locally.
TOKEN_ENCRYPTION_KEY=
    # Used by Google Workspace OAuth Edge Functions to encrypt/decrypt refresh tokens at rest.
    # Must be a cryptographically secure random string (32+ chars recommended).
    # Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
    # Files: supabase/functions/google-workspace-oauth-callback, supabase/functions/google-workspace-sync-users
KDF_SALT=
    # Optional. Deployment-specific salt for PBKDF2 key derivation. Provides defense-in-depth
    # by ensuring each deployment uses a unique salt even if TOKEN_ENCRYPTION_KEY is shared.
    # If not set, falls back to default salt (backwards compatible with existing encrypted data).
    # IMPORTANT: Once set for a deployment, do NOT change - existing encrypted data will become unreadable.
    # Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
    # Files: supabase/functions/_shared/crypto.ts

# ── QuickBooks Online OAuth (Server) — DO NOT EXPOSE TO CLIENT
INTUIT_CLIENT_ID=
    # QuickBooks OAuth client ID from Intuit Developer Portal.
    # Files: supabase/functions/quickbooks-oauth-callback/index.ts, supabase/functions/quickbooks-refresh-tokens/index.ts
    # Note: Also set in Supabase Edge Function secrets for production.
INTUIT_CLIENT_SECRET=
    # QuickBooks OAuth client secret from Intuit Developer Portal. KEEP SECRET!
    # Files: supabase/functions/quickbooks-oauth-callback/index.ts, supabase/functions/quickbooks-refresh-tokens/index.ts
    # Note: MUST be set in Supabase Edge Function secrets for production. Never expose to client.
QB_OAUTH_REDIRECT_BASE_URL=
    # OAuth redirect base URL for the edge function. MUST match VITE_QB_OAUTH_REDIRECT_BASE_URL on the client.
    # If using a custom domain for Supabase (e.g., https://supabase.equipqr.app), set this to that domain.
    # If not set, falls back to SUPABASE_URL (the canonical Supabase project URL).
    # CRITICAL: OAuth 2.0 requires exact redirect_uri match between authorization request and token exchange.
    # Files: supabase/functions/quickbooks-oauth-callback/index.ts
    # Examples:
    #   - Production: https://supabase.equipqr.app
    #   - Preview: https://supabase.preview.equipqr.app
    #   - Local: http://localhost:54321
QUICKBOOKS_SANDBOX=true
    # Set to "true" for sandbox, "false" for production QuickBooks API.
    # Files: supabase/functions/quickbooks-export-invoice/index.ts, supabase/functions/quickbooks-search-customers/index.ts
ENABLE_QB_PDF_ATTACHMENT=false
    # When set to 'true', enables PDF generation and attachment for QuickBooks invoice exports.
    # The PDF will contain only public work order information (public notes, images, and details).
    # Private notes and cost details remain in the invoice's PrivateNote field only.
    # Default: false (disabled). Must be set in Supabase Edge Function secrets for production.
    # Files: supabase/functions/quickbooks-export-invoice/index.ts

# DOCUMENTATION ONLY
# These are stored for convenience of rotating in other parts of the infrastructure
VITE_STRIPE_PUBLISHABLE_KEY=
GOOGLE_MAPS_API_KEY=
VITE_GOOGLE_MAPS_API_KEY=